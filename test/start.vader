# Tests for transformer.

Execute (command:create):
  let c1 = transformer#cmd('test1')
  let c2 = transformer#cmd('test2')
Execute (command:assert):
  AssertEqual c1.cmd, 'test1'
  AssertEqual c2.cmd, 'test2'

Execute (middleware:initial):
  let M = transformer#middle()
  let M2 = transformer#middle()
  let pipe = M.pipe('test')
Execute (middleware:out_type):
  call pipe.out(M.sh())
  call pipe.out(M.reg())
Execute (middleware:assert):
  AssertEqual pipe.type, 'pipe'
  AssertEqual pipe.action, ['test']
  AssertEqual pipe.out_type, 'reg'

Execute (command:exec:pipe):
  let tf = transformer#cmd('TF')
  let tf.middleType = 'pipe'
  let tf.middleOut = 'cmd'
  call tf.exec('*hello*', 'md2html,marked')
  TF
  let tf2 = transformer#cmd('TF2')
  let tf2.middleType = 'pipe'
  let tf2.middleOut = 'cmd'
  call tf2.exec('*hello*', 'md2html,marked')
  TF2
